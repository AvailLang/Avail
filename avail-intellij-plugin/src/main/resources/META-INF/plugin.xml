<idea-plugin>
	<id>avail.plugin.avail-intellij-plugin</id>
	<name>Anvil</name>
	<vendor
		email="avail@availlang.org"
		url="https://www.availlang.org"
	>
		Avail
	</vendor>

	<description>
		<![CDATA[Anvil: the Avail programming language IDE.]]>
	</description>

	<!-- please see https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html
		 on how to target different products -->
	<depends>com.intellij.modules.platform</depends>
	<depends>com.intellij.java</depends>

	<extensions defaultExtensionNs="com.intellij">
		<fileType
			name="Avail File"
			implementationClass="org.availlang.ide.anvil.language.file.AvailFileType"
			fieldName="INSTANCE"
			language="Avail"
			extensions="avail"
		/>
		<fileType
			name="Avail Repo"
			implementationClass="org.availlang.ide.anvil.language.file.AvailRepoFileType"
			fieldName="INSTANCE"
			extensions="repo"
		/>

		<!-- Make the file name pattern "avail.config" be a JSON file. -->
		<fileType
			patterns="anvil.config"
			language="JSON"
			name="JSON"
		/>

		<!-- Grammatical analysis. -->
		<lang.parserDefinition
			language="Avail"
			implementationClass="org.availlang.ide.anvil.language.AnvilParserDefinition"
		/>

		<!-- PSI. -->
		<lang.psiStructureViewFactory
			language="Avail"
			implementationClass="org.availlang.ide.anvil.language.AnvilStructureViewFactory"
		/>
<!--        <fileEditorProvider-->
<!--            implementation="org.availlang.ide.anvil.editor.AvailModuleFileEditorProvider"/>-->
<!--        <lang.fileViewProviderFactory-->
<!--			language="Avail"-->
<!--            implementationClass="org.availlang.ide.anvil.language.psi.AvailFileViewProviderFactory"/>-->
        <moduleBuilder
            builderClass="org.availlang.ide.anvil.module.AnvilModuleTypeBuilder"/>
        <moduleType id="ANVIL_MODULE"
            implementationClass="org.availlang.ide.anvil.module.AnvilModuleType"/>
		<annotator
			language="Avail"
			implementationClass="org.availlang.ide.anvil.language.AvailAnnotator"/>
	</extensions>

	<applicationListeners>
		<listener
			class="org.availlang.ide.anvil.listeners.AnvilProjectOpenListener"
			topic="com.intellij.openapi.project.ProjectManagerListener"
		/>
	</applicationListeners>

	<actions>
		<group
			id="org.availlang.ide.anvil.actions.AnvilActionGroup"
			class="org.availlang.ide.anvil.actions.AnvilActionGroup"
			text="Avail"
			description="Avail actions."
			popup="true"
			icon="/icons/AvailHammer-16px.svg"
		>
			<add-to-group group-id="ToolsMenu" anchor="last"/>
		</group>
		<action
			id="org.availlang.ide.anvil.actions.BuildAction"
			class="org.availlang.ide.anvil.actions.BuildAction"
			text="Build"
			description="Build this Avail file."
			icon="/icons/AvailHammer-16px.svg"
		>
			<add-to-group group-id="EditorPopupMenu" anchor="first"/>
			<keyboard-shortcut
				keymap="$default"
				first-keystroke="shift ctrl B"
			/>
		</action>
	</actions>
</idea-plugin>
